<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åŒ»è¯­é€šAI - æ™ºèƒ½åŒ»å˜±åŠ©æ‰‹</title>
    <style>
        :root {
            /* æ™®é€šç‰ˆé…è‰² */
            --primary-color: #4A90E2;
            --secondary-color: #50E3C2;
            --bg-color: #F5F7FA;
            --card-bg: #FFFFFF;
            --text-main: #2C3E50;
            --text-sub: #7F8C8D;
            --accent-color: #FF6B6B;
            --radius: 16px;
            --font-scale: 1;
            --shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        /* è€å¹´ç‰ˆé…è‰²ä¸å˜é‡é‡å†™ */
        body.senior-mode {
            --primary-color: #D35400; /* é†’ç›®çš„æ©™è‰² */
            --secondary-color: #27AE60; /* é†’ç›®çš„ç»¿è‰² */
            --bg-color: #FFF8E1; /* æš–é»„åº•è‰² */
            --card-bg: #FFFFFF;
            --text-main: #000000;
            --text-sub: #333333;
            --radius: 12px;
            --font-scale: 1.4; /* å­—ä½“æ”¾å¤§ */
            --shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            transition: all 0.5s ease;
        }

        /* ---------------- å¼€å±å¼•å¯¼é¡µç‰¹æ•ˆ (ä¿æŒç²¾ç¾ç‰ˆ) ---------------- */
        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 10% 20%, rgb(80, 227, 194) 0%, rgb(74, 144, 226) 90%);
            z-index: 999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.6s ease;
            overflow: hidden;
        }

        #splash-screen::before {
            content: '';
            position: absolute;
            top: -100px;
            right: -100px;
            width: 300px;
            height: 300px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            filter: blur(50px);
        }

        .splash-content {
            z-index: 2;
            text-align: center;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .splash-logo {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 10px;
            letter-spacing: 2px;
            background: linear-gradient(to bottom, #ffffff 0%, #e0f2f1 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));
            animation: float 3s ease-in-out infinite;
        }

        .splash-slogan {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.9);
            letter-spacing: 6px;
            margin-bottom: 60px;
            font-weight: 300;
            text-transform: uppercase;
            border-top: 1px solid rgba(255,255,255,0.4);
            border-bottom: 1px solid rgba(255,255,255,0.4);
            padding: 8px 15px;
            display: inline-block;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .mode-select-container {
            width: 85%;
            max-width: 380px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .mode-btn {
            background: rgba(255, 255, 255, 0.95);
            border: none;
            padding: 22px 25px;
            border-radius: 20px;
            font-size: 1.1rem;
            font-weight: bold;
            color: #4A90E2;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s, background 0.2s, box-shadow 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
        }

        .mode-btn::after {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 5px; height: 100%;
            background: #4A90E2;
        }

        .mode-btn:active {
            transform: scale(0.97);
        }

        .mode-btn span { font-size: 1.8rem; }
        
        .mode-btn.senior {
            color: #D35400;
        }
        .mode-btn.senior::after {
            background: #D35400;
        }

        .footer-note {
            position: absolute;
            bottom: 30px;
            color: rgba(255,255,255,0.6);
            font-size: 0.8rem;
        }
        
        /* ---------------- ä¸»åº”ç”¨ç»“æ„ ---------------- */

        .app-container {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.5s;
        }

        .header {
            padding: 20px;
            background: var(--card-bg);
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
        }

        .header h1 {
            font-size: calc(1.2rem * var(--font-scale));
            color: var(--primary-color);
        }

        .version-switch {
            padding: 8px 16px;
            border-radius: 20px;
            background: var(--bg-color);
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        /* é¡µé¢ç®¡ç† */
        .page {
            position: absolute;
            top: 60px;
            left: 0;
            width: 100%;
            height: calc(100% - 60px);
            background: var(--bg-color);
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 5;
        }

        .page.active {
            transform: translateX(0);
            z-index: 20;
        }

        .page#home {
            transform: translateX(0);
            z-index: 1;
        }

        /* é€šç”¨ç»„ä»¶ */
        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow);
            transition: transform 0.2s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .card:active {
            transform: scale(0.98);
        }

        .card h3 {
            font-size: calc(1.1rem * var(--font-scale));
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card p {
            font-size: calc(0.9rem * var(--font-scale));
            color: var(--text-sub);
            line-height: 1.5;
        }

        .btn-back {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--text-main);
            color: white;
            padding: 12px 30px;
            border-radius: 30px;
            border: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            font-size: calc(1rem * var(--font-scale));
            z-index: 100;
            cursor: pointer;
        }

        /* ---------------- é¦–é¡µå¸ƒå±€ ---------------- */
        
        /* æ™®é€šç‰ˆèœå• */
        .normal-menu {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .normal-menu .card.full-width {
            grid-column: span 2;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }
        
        .normal-menu .card.full-width h3, 
        .normal-menu .card.full-width p {
            color: white;
        }

        /* è€å¹´ç‰ˆèœå• */
        .senior-menu {
            display: none;
            flex-direction: column;
            gap: 20px;
            height: 100%;
        }

        body.senior-mode .normal-menu { display: none; }
        body.senior-mode .senior-menu { display: flex; }

        .big-btn {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            padding: 0 30px;
            border-radius: 20px;
            font-weight: bold;
            color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
            font-size: 1.8rem;
            position: relative;
        }
        
        .big-btn .icon-large {
            font-size: 3rem;
            margin-right: 20px;
        }

        .bg-blue { background: #4A90E2; }
        .bg-green { background: #27AE60; }
        .bg-orange { background: #F39C12; }
        .bg-red { background: #E74C3C; }
        .bg-purple { background: #9B59B6; } /* ç—‡çŠ¶æ€»ç»“æ–°è‰² */

        /* ---------------- è¯­éŸ³åŠ©æ‰‹ ---------------- */
        #voice-assistant-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%); 
            display: none;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 200;
            font-size: 40px;
            animation: pulse-mic 2s infinite;
            border: 4px solid white;
        }
        
        @keyframes pulse-mic {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        body.senior-mode #voice-assistant-btn { display: flex; }

        .voice-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 300;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
        }

        /* ---------------- å½•éŸ³ & ç—‡çŠ¶ ç•Œé¢ ---------------- */
        .record-circle {
            width: 120px;
            height: 120px;
            background: var(--primary-color);
            border-radius: 50%;
            margin: 50px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            box-shadow: 0 0 0 0 rgba(74, 144, 226, 0.7);
            animation: pulse-blue 2s infinite;
            cursor: pointer;
        }

        @keyframes pulse-blue {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(74, 144, 226, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 30px rgba(74, 144, 226, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(74, 144, 226, 0); }
        }

        /* ---------------- ç—‡çŠ¶æ€»ç»“å¯¹æ¯”å¡ç‰‡ ---------------- */
        .symptom-box {
            background: #fff;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid #eee;
        }
        
        .symptom-box.raw {
            border-left: 4px solid #ccc;
            background: #f9f9f9;
        }
        
        .symptom-box.pro {
            border-left: 4px solid var(--secondary-color);
            background: #E8F8F5;
        }

        .symptom-label {
            font-size: 0.9em;
            color: var(--text-sub);
            margin-bottom: 5px;
            font-weight: bold;
        }

        /* ---------------- å‘¼å« & é€šè¯ä¸­ç•Œé¢ ---------------- */
        .call-modal, .sos-modal, .calling-interface {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 400;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            text-align: center;
        }

        /* æ‹¨æ‰“ä¸­ç•Œé¢ç‰¹æœ‰æ ·å¼ */
        .calling-avatar {
            width: 150px; height: 150px;
            border-radius: 50%;
            background: #bdc3c7;
            margin-bottom: 30px;
            display: flex; align-items: center; justify-content: center;
            font-size: 4rem;
            box-shadow: 0 0 50px rgba(255,255,255,0.1);
            animation: pulse-ring 2s infinite;
        }
        
        @keyframes pulse-ring {
            0% { box-shadow: 0 0 0 0 rgba(255,255,255, 0.4); }
            70% { box-shadow: 0 0 0 30px rgba(255,255,255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255,255,255, 0); }
        }

        .calling-name { font-size: 2rem; font-weight: bold; margin-bottom: 10px; }
        .calling-status { font-size: 1.2rem; opacity: 0.7; margin-bottom: 50px; }
        .btn-hangup {
            width: 80px; height: 80px;
            background: #E74C3C;
            border-radius: 50%;
            border: none;
            display: flex; align-items: center; justify-content: center;
            font-size: 2rem;
            color: white;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(231, 76, 60, 0.3);
        }

        /* ä¹‹å‰çš„å¼¹çª—æ ·å¼ */
        .call-avatar {
            width: 100px; height: 100px; border-radius: 50%;
            background: #fff; margin-bottom: 20px; overflow: hidden;
            display: flex; align-items: center; justify-content: center; font-size: 3rem;
        }
        .modal-btn {
            padding: 15px 40px; border-radius: 30px; border: none;
            font-size: 1.2rem; margin-top: 20px; cursor: pointer;
            width: 80%; max-width: 300px;
        }
        .btn-cancel { background: transparent; border: 1px solid white; color: white; }
        .btn-confirm { background: #2ecc71; color: white; }

        /* åˆ†æåŠ¨ç”»è¦†ç›–å±‚ */
        .analyzing-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.95); z-index: 50;
            display: none; flex-direction: column; align-items: center; justify-content: center;
        }
        .waves { display: flex; height: 100px; align-items: center; }
        .wave-line { width: 5px; height: 50px; background: var(--primary-color); margin: 0 3px; border-radius: 5px; animation: wave 1s ease-in-out infinite; }
        .wave-line:nth-child(1) { animation-delay: 0.1s; } .wave-line:nth-child(2) { animation-delay: 0.2s; }
        .wave-line:nth-child(3) { animation-delay: 0.3s; } .wave-line:nth-child(4) { animation-delay: 0.4s; } .wave-line:nth-child(5) { animation-delay: 0.5s; }
        @keyframes wave { 0%, 100% { height: 20px; } 50% { height: 80px; } }

        /* é—¹é’Ÿæ ·å¼ */
        .clock-container { padding: 20px 0; }
        .clock-item {
            background: var(--card-bg); border-radius: var(--radius); padding: 20px;
            margin-bottom: 20px; display: flex; align-items: center; box-shadow: var(--shadow);
            position: relative; border-left: 6px solid var(--primary-color);
        }
        .clock-time { font-size: calc(1.5rem * var(--font-scale)); font-weight: bold; color: var(--primary-color); margin-right: 20px; min-width: 80px; text-align: center; }
        .clock-info { flex: 1; }
        .clock-name { font-size: calc(1.1rem * var(--font-scale)); font-weight: bold; margin-bottom: 5px; }
        .clock-detail { color: var(--text-sub); font-size: calc(0.9rem * var(--font-scale)); }

        /* æœ¯è¯­æ ·å¼ */
        .search-box { width: 100%; padding: 12px; border: 2px solid #eee; border-radius: 10px; font-size: 1rem; margin-bottom: 15px; }
        .empty-state { text-align: center; color: var(--text-sub); margin-top: 50px; font-size: calc(1rem * var(--font-scale)); }
        .highlight-term-box { border-left: 4px solid var(--accent-color); background: #FFF0F0; padding: 15px; margin-bottom: 10px; border-radius: 4px; }

        /* SOSæ ·å¼ */
        .sos-circle { width: 150px; height: 150px; border-radius: 50%; background: #e74c3c; display: flex; align-items: center; justify-content: center; font-size: 3rem; margin-bottom: 20px; animation: sos-pulse 1s infinite; }
        @keyframes sos-pulse { 0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7); } 100% { transform: scale(1.1); box-shadow: 0 0 0 30px rgba(231, 76, 60, 0); } }

    </style>
</head>
<body>

<!-- 1. å¼€å±å¼•å¯¼æ¨¡å¼é€‰æ‹© -->
<div id="splash-screen">
    <div class="splash-content">
        <div class="splash-logo">åŒ»è¯­é€šAI</div>
        <div class="splash-slogan">å¬æ‡‚æ–¹è¨€ Â· å®ˆæŠ¤å¥åº·</div>
        
        <div class="mode-select-container">
            <button class="mode-btn" onclick="initApp(false)">
                æ™®é€šæ¨¡å¼
                <span>ğŸ“±</span>
            </button>
            <button class="mode-btn senior" onclick="initApp(true)">
                å…³æ€€æ¨¡å¼ (å¤§å­—ç‰ˆ)
                <span>ğŸ‘´ğŸ‘µ</span>
            </button>
        </div>
    </div>
    <div class="footer-note">è´´å¿ƒçš„åŒ»ç–—è¯­éŸ³ç¿»è¯‘åŠ©æ‰‹</div>
</div>

<!-- 2. Appä¸»ä½“å®¹å™¨ -->
<div class="app-container" id="app-main">
    <div class="header">
        <h1>åŒ»è¯­é€šAI</h1>
        <button class="version-switch" onclick="toggleVersion()">åˆ‡æ¢ç‰ˆæœ¬</button>
    </div>

    <!-- é¦–é¡µ -->
    <div id="home" class="page active">
        
        <!-- æ™®é€šç‰ˆèœå• -->
        <div class="normal-menu">
            <!-- å½•éŸ³å…¥å£ -->
            <div class="card" onclick="openPage('record')">
                <h3>ğŸ™ï¸ å¬åŒ»ç”Ÿè¯´</h3>
                <p>å½•éŸ³å¹¶ç¿»è¯‘åŒ»å˜±</p>
            </div>

             <!-- æ–°å¢ï¼šç—‡çŠ¶æ€»ç»“å…¥å£ -->
             <div class="card" onclick="openPage('symptom-summary')">
                <h3>ğŸ¤’ ç—‡çŠ¶æ€»ç»“</h3>
                <p>è·ŸåŒ»ç”Ÿè¯´å•¥ï¼ŸAIå¸®æ‚¨ç†</p>
            </div>

            <!-- ç”¨è¯æé†’ -->
            <div class="card" onclick="checkDataAndOpen('medication')">
                <h3>â° ç”¨è¯æé†’</h3>
                <p id="med-desc">æš‚æ— å¾…åŠ</p>
            </div>

            <!-- æœ¯è¯­è§£é‡Š -->
            <div class="card" onclick="checkDataAndOpen('terms')">
                <h3>ğŸ“– æœ¯è¯­è§£é‡Š</h3>
                <p>ä¸æ‡‚çš„è¯ç‚¹è¿™é‡Œ</p>
            </div>

            <!-- å‘¼å«å®¶äºº -->
            <div class="card full-width" onclick="showCallModal()">
                <h3>ğŸ“ å‘¼å«å®¶äºº</h3>
                <p>è”ç³»ç´§æ€¥äºº</p>
            </div>
        </div>

        <!-- è€å¹´ç‰ˆèœå• -->
        <div class="senior-menu">
            <div class="big-btn bg-blue" onclick="openPage('record')">
                <span class="icon-large">ğŸ™ï¸</span>
                å¬åŒ»ç”Ÿè¯´
            </div>
            
            <!-- æ–°å¢ï¼šè€å¹´ç‰ˆç—‡çŠ¶æ€»ç»“ -->
            <div class="big-btn bg-purple" onclick="openPage('symptom-summary')">
                <span class="icon-large">ğŸ—£ï¸</span>
                è·ŸåŒ»ç”Ÿè¯´ç—…
            </div>

            <div class="big-btn bg-green" onclick="checkDataAndOpen('medication')">
                <span class="icon-large">ğŸ’Š</span>
                æ€ä¹ˆåƒè¯
            </div>

            <div class="big-btn bg-orange" onclick="checkDataAndOpen('terms')">
                <span class="icon-large">ğŸ“–</span>
                è¿™ä¸ªå•¥æ„æ€
            </div>

            <div class="big-btn bg-red" onclick="showSOS()">
                <span class="icon-large">ğŸ†˜</span>
                æ•‘å‘½ / å«äºº
            </div>
            
            <div style="text-align: center; color: #666; font-size: 1rem; margin-top: 10px;">
                ğŸ‘‡ æŒ‰å³ä¸‹è§’è¯ç­’ï¼Œç›´æ¥ç”¨å˜´å·´è¯´
            </div>
        </div>
    </div>

    <!-- å½•éŸ³é¡µé¢ -->
    <div id="record" class="page">
        <h2 style="text-align:center; margin-top:20px; font-size: calc(1.5rem * var(--font-scale));">æ­£åœ¨è†å¬åŒ»ç”Ÿ...</h2>
        <p style="text-align:center; color:#666; margin-bottom:20px;">æ”¯æŒï¼šå·æ¸ã€ç²¤è¯­ã€ä¸œåŒ—è¯ <-> æ™®é€šè¯</p>
        
        <div class="record-circle" onclick="stopRecording('result')">
            ğŸ™ï¸
        </div>
        <p style="text-align:center;">ç‚¹å‡»éº¦å…‹é£ç»“æŸå¹¶åˆ†æ</p>

        <!-- å®æ—¶å­—å¹• -->
        <div style="margin-top: 30px; padding: 20px; background: rgba(0,0,0,0.03); border-radius: 10px; height: 200px; overflow: hidden;">
            <p style="opacity: 0.5;">(å®æ—¶è½¬æ–‡å­—ä¸­...)</p>
            <p id="live-text" style="font-size: 1.2rem; margin-top: 10px;"></p>
        </div>

        <button class="btn-back" onclick="closePage('record')">å–æ¶ˆ</button>
    </div>

    <!-- æ–°å¢ï¼šç—‡çŠ¶æ€»ç»“é¡µé¢ -->
    <div id="symptom-summary" class="page">
        <h2 style="text-align:center; margin-top:10px;">æˆ‘è¦è¯´ç—‡çŠ¶</h2>
        <p style="text-align:center; color:#666;">å“ªé‡Œä¸èˆ’æœï¼Ÿå¯¹ç€æ‰‹æœºè¯´ï¼ŒAIå¸®æ‚¨å˜ä¸“ä¸š</p>
        
        <!-- å½•éŸ³æŒ‰é’® -->
        <div id="symptom-input-area" style="text-align: center;">
            <div class="record-circle" style="background: #9B59B6;" onclick="stopSymptomRecording()">
                ğŸ—£ï¸
            </div>
            <p>ç‚¹å‡»å¼€å§‹/ç»“æŸè¯´è¯</p>
        </div>

        <!-- ç»“æœå±•ç¤ºåŒºåŸŸ (é»˜è®¤éšè—) -->
        <div id="symptom-result-area" style="display:none; margin-top:20px;">
            <div class="symptom-box raw">
                <div class="symptom-label">æ‚¨è¯´çš„æ˜¯ï¼š</div>
                <p id="raw-symptom-text">"æˆ‘è¿™ä¸ªè‚šå­ç—›å¾—å¾ˆï¼Œæ˜¨å¤©åƒäº†ä¸ªå†°è¥¿ç“œï¼Œç„¶åå°±ä¸€ç›´æ‹‰è‚šå­ï¼Œæ‹‰æ°´ä¸€æ ·..."</p>
            </div>
            
            <div style="text-align:center; font-size: 2rem; margin: 10px 0;">â¬‡ï¸ AI å˜èº« â¬‡ï¸</div>

            <div class="symptom-box pro">
                <div class="symptom-label">ç»™åŒ»ç”Ÿçœ‹è¿™ä¸ª (æ›´é«˜æ•ˆ)ï¼š</div>
                <p id="pro-symptom-text" style="font-size: 1.2rem; font-weight: bold; color: #2C3E50;">
                    ä¸»è¯‰ï¼šè…¹ç—›ä¼´è…¹æ³»1å¤©ã€‚<br>
                    ç°ç—…å²ï¼šæ‚£è€…æ˜¨æ—¥è¿›é£Ÿç”Ÿå†·é£Ÿç‰©ï¼ˆå†°è¥¿ç“œï¼‰åå‡ºç°è…¹ç—›ï¼Œç»§è€Œå‡ºç°æ°´æ ·ä¾¿è…¹æ³»ã€‚<br>
                    æ—¢å¾€å²ï¼šæ— ç‰¹æ®Šã€‚
                </p>
            </div>
            
            <button class="card" style="width:100%; text-align:center; background:var(--secondary-color); color:white; border:none;" onclick="alert('å·²å¤åˆ¶ï¼Œå¯ç›´æ¥å‘ç»™åŒ»ç”Ÿ')">å¤åˆ¶æ–‡å­—</button>
        </div>

        <button class="btn-back" onclick="closePage('symptom-summary')">è¿”å›é¦–é¡µ</button>
    </div>

    <!-- åˆ†æç»“æœ/å¯¹è¯è¯¦æƒ…é¡µ -->
    <div id="result" class="page">
        <h2 style="margin-bottom: 20px;">æœ¬æ¬¡å°±è¯Šè®°å½•</h2>
        <div class="chat-container" id="chat-content"></div>
        <button class="btn-back" onclick="closePage('result')">è¿”å›é¦–é¡µ</button>
    </div>

    <!-- ç”¨è¯æé†’é¡µ -->
    <div id="medication" class="page">
        <h2>â° ä»Šæ—¥ç”¨è¯è®¡åˆ’</h2>
        <div class="clock-container" id="med-list">
            <div class="empty-state">
                <div style="font-size: 3rem; margin-bottom: 10px;">ğŸ•’</div>
                <p>æš‚æ— æ•°æ®ï¼Œè¯·å…ˆè¿›è¡Œå½•éŸ³è¯Šæ–­åˆ†æã€‚</p>
            </div>
        </div>
        <button class="btn-back" onclick="closePage('medication')">è¿”å›</button>
    </div>

    <!-- æœ¯è¯­è§£é‡Šé¡µ -->
    <div id="terms" class="page">
        <h2>ğŸ“– æœ¯è¯­æ™ºèƒ½ç¿»è¯‘</h2>
        <input type="text" class="search-box" placeholder="è¾“å…¥åŒ»å­¦åè¯æœç´¢..." onkeyup="filterTerms()">
        <div id="term-list">
             <div class="empty-state"><p>æš‚æ— è¯†åˆ«åˆ°çš„æœ¯è¯­ï¼Œè¯·å…ˆå½•éŸ³ã€‚</p></div>
        </div>
        <button class="btn-back" onclick="closePage('terms')">è¿”å›</button>
    </div>

</div>

<!-- è¯­éŸ³åŠ©æ‰‹æ‚¬æµ®çƒ (ä»…è€å¹´æ¨¡å¼) -->
<div id="voice-assistant-btn" onclick="startVoiceAssistant()">ğŸ¤</div>

<!-- è¯­éŸ³è¯†åˆ«è¦†ç›–å±‚ -->
<div id="voice-overlay" class="voice-overlay">
    <div class="waves">
        <div class="wave-line"></div><div class="wave-line"></div><div class="wave-line"></div>
    </div>
    <h2 style="margin-top:20px;">æ­£åœ¨å¬æ‚¨è¯´...</h2>
    <p style="margin-top:10px; opacity:0.8;">"æˆ‘è¦å½•éŸ³"ã€"æˆ‘è¦è¯´ç—‡çŠ¶"ã€"æ•‘å‘½"</p>
    <div id="voice-result" style="margin-top: 20px; font-weight: bold; color: #50E3C2; font-size: 1.5rem; height: 40px;"></div>
</div>

<!-- åˆ†æåŠ¨ç”»å±‚ -->
<div id="analyzing" class="analyzing-overlay">
    <div class="waves">
        <div class="wave-line"></div><div class="wave-line"></div><div class="wave-line"></div><div class="wave-line"></div><div class="wave-line"></div>
    </div>
    <h2 style="margin-top: 20px; color: var(--primary-color);">AIæ­£åœ¨æ™ºèƒ½åˆ†æ...</h2>
    <p>æ•´ç†é€»è¾‘ | è½¬æ¢æœ¯è¯­ | ç”Ÿæˆæ‘˜è¦</p>
</div>

<!-- å‘¼å«ç¡®è®¤å¼¹çª— -->
<div id="call-modal" class="call-modal">
    <div class="call-avatar">ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦</div>
    <h3>å³å°†å‘¼å«ï¼šå„¿å­</h3>
    <p style="font-size: 1.5rem; margin-top: 10px;">138-0013-8000</p>
    <button class="modal-btn btn-confirm" onclick="startFakeCall()">ç«‹å³æ‹¨æ‰“</button>
    <button class="modal-btn btn-cancel" onclick="hideModals()">å–æ¶ˆ</button>
</div>

<!-- æ–°å¢ï¼šé€šè¯ä¸­æ¨¡æ‹Ÿç•Œé¢ -->
<div id="calling-interface" class="calling-interface">
    <div class="calling-avatar">ğŸ‘¤</div>
    <div class="calling-name">å„¿å­</div>
    <div class="calling-status" id="call-timer">æ­£åœ¨å‘¼å«...</div>
    
    <div style="display: flex; gap: 40px;">
        <!-- æ‰©å±•åŠŸèƒ½é’® -->
        <div style="display:flex; flex-direction:column; align-items:center; opacity:0.6;">
            <div style="width:60px; height:60px; border-radius:50%; border:1px solid white; display:flex; align-items:center; justify-content:center; margin-bottom:10px;">ğŸ”‡</div>
            <span>é™éŸ³</span>
        </div>
        
        <button class="btn-hangup" onclick="endFakeCall()">ğŸ“</button>
        
         <div style="display:flex; flex-direction:column; align-items:center; opacity:0.6;">
            <div style="width:60px; height:60px; border-radius:50%; border:1px solid white; display:flex; align-items:center; justify-content:center; margin-bottom:10px;">âŒ¨ï¸</div>
            <span>æ‹¨å·</span>
        </div>
    </div>
</div>

<!-- SOS å€’è®¡æ—¶å±‚ -->
<div id="sos-modal" class="sos-modal">
    <div class="sos-circle" id="sos-counter">5</div>
    <h3>æ­£åœ¨å‘é€ç´§æ€¥æ±‚åŠ©...</h3>
    <p>å°†å‘é€æ‚¨çš„å®šä½å’Œå½•éŸ³ç»™ç´§æ€¥è”ç³»äºº</p>
    <button class="modal-btn btn-cancel" onclick="cancelSOS()">å–æ¶ˆå‘é€</button>
</div>

<script>
    // å…¨å±€çŠ¶æ€æ•°æ®
    let isSeniorMode = false;
    let hasAnalyzed = false;

    // æ¨¡æ‹Ÿæ•°æ®æº
    const mockData = {
        chat: [
            {
                role: 'patient',
                raw: 'åŒ»ç”Ÿå•Šï¼Œæˆ‘è¿™è„‘å£³æ˜å¾—å¾ˆï¼Œç‰¹åˆ«æ˜¯æ—©ä¸Šçˆ¬èµ·æ¥çš„æ—¶å€™ã€‚', 
                trans: 'åŒ»ç”Ÿï¼Œæˆ‘å¤´æ™•å¾—å¾ˆå‰å®³ï¼Œç‰¹åˆ«æ˜¯æ—©ä¸Šèµ·åºŠçš„æ—¶å€™ã€‚ï¼ˆå·æ¸æ–¹è¨€ -> æ™®é€šè¯ï¼‰'
            },
            {
                role: 'doctor',
                raw: 'æ ¹æ®æ£€æŸ¥ï¼Œä½ è¿™æ˜¯<span class="term-highlight">åŸå‘æ€§é«˜è¡€å‹</span>å¼•èµ·çš„çœ©æ™•ã€‚æ³¨æ„<span class="term-highlight">ä½é’ é¥®é£Ÿ</span>ã€‚',
                trans: 'æ ¹æ®æ£€æŸ¥ï¼Œä½ è¿™æ˜¯è¡€å‹é«˜å¯¼è‡´çš„å¤´æ™•ã€‚åƒé¥­è¦å°‘æ”¾ç›å·´ï¼Œè«åƒå’¸èœã€‚ï¼ˆåŒ»ç”Ÿæ™®é€šè¯ -> ç”Ÿæ´»åŒ–æ–¹è¨€è§£é‡Šï¼‰'
            },
            {
                role: 'doctor',
                raw: 'ç»™ä½ å¼€äº†<span class="term-highlight">è‹¯ç£ºé…¸æ°¨æ°¯åœ°å¹³ç‰‡</span>ï¼Œä¸€å¤©ä¸€æ¬¡ï¼Œä¸€æ¬¡ä¸€ç‰‡ï¼Œæ—©ä¸Šåƒã€‚',
                trans: 'ç»™ä½ å¼€äº†ä¸ªé™å‹è¯ï¼ˆç™½è‰²çš„åœ†ç‰‡ç‰‡ï¼‰ï¼Œæ¯å¤©æ—©ä¸Šèµ·æ¥åƒä¸€é¢—ï¼Œä¸è¦å¿˜äº†å“ˆã€‚ï¼ˆç”¨è¯æŒ‡å¯¼ -> é€šä¿—æ–¹è¨€ï¼‰'
            }
        ],
        meds: [
            { name: 'è‹¯ç£ºé…¸æ°¨æ°¯åœ°å¹³ç‰‡', dosage: '1ç‰‡', time: '08:00', detail: 'æ—©é¤åæœç”¨ï¼Œç™½è‰²åœ†ç‰‡' },
            { name: 'é˜¿å¸åŒ¹æ—è‚ æº¶ç‰‡', dosage: '1ç‰‡', time: '12:00', detail: 'åˆé¤åæœç”¨' }
        ],
        terms: [
            { title: 'åŸå‘æ€§é«˜è¡€å‹', desc: 'åŸå› ä¸æ˜çš„é«˜è¡€å‹ï¼Œå°±åƒæ°´ç®¡é‡Œçš„æ°´å‹ä¸€ç›´å¤ªé«˜ï¼Œå®¹æ˜“æŠŠç®¡å­æ’‘åã€‚', tags: ['å¸¸è§ç—…'] },
            { title: 'ä½é’ é¥®é£Ÿ', desc: 'å°±æ˜¯å°‘åƒç›ï¼åŒ…æ‹¬é…±æ²¹ã€å’¸èœã€è…Šè‚‰éƒ½è¦å°‘åƒã€‚', tags: ['ç”Ÿæ´»'] },
            { title: 'è‹¯ç£ºé…¸æ°¨æ°¯åœ°å¹³', desc: 'ä¸€ç§å¸¸è§çš„é•¿æ•ˆé™å‹è¯ï¼Œä½œç”¨æ˜¯è®©è¡€ç®¡æ”¾æ¾ï¼Œè¡€å‹å°±é™ä¸‹æ¥äº†ã€‚', tags: ['è¯ç‰©'] }
        ]
    };

    // 1. åˆå§‹åŒ–App
    function initApp(mode) {
        isSeniorMode = mode;
        if(isSeniorMode) {
            document.body.classList.add('senior-mode');
        } else {
            document.body.classList.remove('senior-mode');
        }
        const btn = document.querySelector('.version-switch');
        btn.innerText = isSeniorMode ? 'åˆ‡æ¢æ™®é€šç‰ˆ' : 'åˆ‡æ¢è€å¹´ç‰ˆ';
        document.getElementById('splash-screen').style.opacity = '0';
        setTimeout(() => {
            document.getElementById('splash-screen').style.display = 'none';
            document.getElementById('app-main').style.opacity = '1';
        }, 500);
    }

    // åˆ‡æ¢ç‰ˆæœ¬
    function toggleVersion() {
        isSeniorMode = !isSeniorMode;
        document.body.classList.toggle('senior-mode');
        const btn = document.querySelector('.version-switch');
        btn.innerText = isSeniorMode ? 'åˆ‡æ¢æ™®é€šç‰ˆ' : 'åˆ‡æ¢è€å¹´ç‰ˆ';
    }

    // é¡µé¢è·³è½¬
    function openPage(id) {
        document.getElementById(id).classList.add('active');
        if(id === 'record') {
            startLiveText();
        }
        // é‡ç½®ç—‡çŠ¶é¡µ
        if(id === 'symptom-summary') {
            document.getElementById('symptom-input-area').style.display = 'block';
            document.getElementById('symptom-result-area').style.display = 'none';
        }
    }

    function closePage(id) {
        document.getElementById(id).classList.remove('active');
    }

    // æ£€æŸ¥æ•°æ®æ˜¯å¦å­˜åœ¨å†æ‰“å¼€
    function checkDataAndOpen(id) {
        if (!hasAnalyzed) {
            alert(isSeniorMode ? "è¯·æ‚¨å…ˆç‚¹ã€å¬åŒ»ç”Ÿè¯´ã€‘å½•éŸ³ï¼" : "è¯·å…ˆè¿›è¡Œã€å½•éŸ³ã€‘å¹¶åˆ†æï¼ŒAIæ‰èƒ½ä¸ºæ‚¨ç”Ÿæˆæ™ºèƒ½å†…å®¹ã€‚");
            return;
        }
        openPage(id);
    }

    // æ¨¡æ‹Ÿå®æ—¶å­—å¹•
    let liveInterval;
    function startLiveText() {
        const text = "åŒ»ç”Ÿå•Šï¼Œæˆ‘è¿™è„‘å£³æ˜å¾—å¾ˆ...";
        let i = 0;
        const el = document.getElementById('live-text');
        el.innerText = "";
        liveInterval = setInterval(() => {
            el.innerText += text[i];
            i++;
            if(i >= text.length) clearInterval(liveInterval);
        }, 200);
    }

    // åœæ­¢å½•éŸ³å¹¶åˆ†æ (é€šç”¨)
    function stopRecording(targetPage) {
        clearInterval(liveInterval);
        const overlay = document.getElementById('analyzing');
        overlay.style.display = 'flex';
        
        setTimeout(() => {
            overlay.style.display = 'none';
            hasAnalyzed = true;
            generateContent(); 
            closePage('record');
            openPage(targetPage);
            
            // é¦–é¡µçŠ¶æ€æ›´æ–°
            document.getElementById('med-desc').innerText = "ä»Šæ—¥æœ‰ 2 é¡¹ç”¨è¯å¾…åŠ";
            document.getElementById('med-desc').style.color = "var(--accent-color)";
        }, 3000);
    }

    // ç—‡çŠ¶æ€»ç»“å½•éŸ³é€»è¾‘
    function stopSymptomRecording() {
        const overlay = document.getElementById('analyzing');
        overlay.querySelector('h2').innerText = "AIæ­£åœ¨æ•´ç†æ‚¨çš„ç—‡çŠ¶...";
        overlay.style.display = 'flex';
        
        setTimeout(() => {
            overlay.style.display = 'none';
            document.getElementById('symptom-input-area').style.display = 'none';
            document.getElementById('symptom-result-area').style.display = 'block';
            // æ¢å¤æ–‡å­—
            overlay.querySelector('h2').innerText = "AIæ­£åœ¨æ™ºèƒ½åˆ†æåŒ»å˜±...";
        }, 2000);
    }

    // ç”Ÿæˆæ•°æ®å†…å®¹
    function generateContent() {
        const chatBox = document.getElementById('chat-content');
        chatBox.innerHTML = '';
        mockData.chat.forEach(item => {
            const div = document.createElement('div');
            div.className = `bubble ${item.role}`;
            div.innerHTML = `<div>${item.raw}</div><span class="translation">ğŸ—£ï¸ ${item.trans}</span>`;
            chatBox.appendChild(div);
        });

        const medBox = document.getElementById('med-list');
        medBox.innerHTML = '';
        mockData.meds.forEach(med => {
            const item = document.createElement('div');
            item.className = 'clock-item';
            item.innerHTML = `
                <div class="clock-time">${med.time}</div>
                <div class="clock-info"><div class="clock-name">${med.name}</div><div class="clock-detail">ç”¨é‡ï¼š${med.dosage} | ${med.detail}</div></div>
                <div class="clock-toggle">ğŸ””</div>
            `;
            medBox.appendChild(item);
        });

        renderTerms(mockData.terms);
    }

    function renderTerms(data) {
        const termBox = document.getElementById('term-list');
        termBox.innerHTML = '';
        data.forEach(term => {
            const div = document.createElement('div');
            div.className = 'highlight-term-box';
            div.innerHTML = `<h4 style="color:var(--text-main); font-size:1.1em;">${term.title}</h4><p style="color:var(--text-sub); margin-top:5px;">${term.desc}</p>`;
            termBox.appendChild(div);
        });
    }

    function filterTerms() {
        const input = document.querySelector('.search-box').value.toLowerCase();
        const filtered = mockData.terms.filter(t => t.title.includes(input));
        renderTerms(filtered);
    }

    // ---------------- è¯­éŸ³åŠ©æ‰‹é€»è¾‘ ----------------
    function startVoiceAssistant() {
        const overlay = document.getElementById('voice-overlay');
        const resultText = document.getElementById('voice-result');
        overlay.style.display = 'flex';
        resultText.innerText = "";
        
        setTimeout(() => {
            // æ–°å¢ "æˆ‘è¦è¯´ç—‡çŠ¶" çš„æ„å›¾
            const intents = [
                { text: "æˆ‘è¦å½•éŸ³", action: () => openPage('record') },
                { text: "æˆ‘è¦è¯´ç—‡çŠ¶", action: () => openPage('symptom-summary') },
                { text: "æˆ‘è¦åƒè¯", action: () => checkDataAndOpen('medication') },
                { text: "æ•‘å‘½", action: () => showSOS() }
            ];
            const randomIntent = intents[Math.floor(Math.random() * intents.length)];
            resultText.innerText = `è¯†åˆ«åˆ°ï¼š"${randomIntent.text}"`;
            setTimeout(() => {
                overlay.style.display = 'none';
                randomIntent.action();
            }, 1000);
        }, 2000);
    }

    // ---------------- å‘¼å« & é€šè¯æ¨¡æ‹Ÿé€»è¾‘ (æ–°åŠŸèƒ½) ----------------
    function showCallModal() {
        document.getElementById('call-modal').style.display = 'flex';
    }

    function hideModals() {
        document.getElementById('call-modal').style.display = 'none';
        document.getElementById('sos-modal').style.display = 'none';
        document.getElementById('calling-interface').style.display = 'none';
    }

    let callTimerInt;
    function startFakeCall() {
        // éšè—ç¡®è®¤å¼¹çª—
        document.getElementById('call-modal').style.display = 'none';
        // æ˜¾ç¤ºé€šè¯ç•Œé¢
        const callUI = document.getElementById('calling-interface');
        callUI.style.display = 'flex';
        const timerEl = document.getElementById('call-timer');
        timerEl.innerText = "æ­£åœ¨å‘¼å«...";
        
        // æ¨¡æ‹Ÿæ¥é€š
        setTimeout(() => {
            let seconds = 0;
            timerEl.innerText = "00:00";
            callTimerInt = setInterval(() => {
                seconds++;
                const min = Math.floor(seconds / 60).toString().padStart(2, '0');
                const sec = (seconds % 60).toString().padStart(2, '0');
                timerEl.innerText = `${min}:${sec}`;
            }, 1000);
        }, 2000);
    }

    function endFakeCall() {
        clearInterval(callTimerInt);
        hideModals();
        alert("é€šè¯å·²ç»“æŸ");
    }

    // ---------------- SOS äº¤äº’é€»è¾‘ ----------------
    let sosTimer;
    function showSOS() {
        const modal = document.getElementById('sos-modal');
        const counter = document.getElementById('sos-counter');
        modal.style.display = 'flex';
        let count = 5;
        counter.innerText = count;

        sosTimer = setInterval(() => {
            count--;
            counter.innerText = count;
            if(count <= 0) {
                clearInterval(sosTimer);
                alert("å·²å‘é€æ±‚åŠ©çŸ­ä¿¡ä¸ä½ç½®ï¼");
                hideModals();
            }
        }, 1000);
    }

    function cancelSOS() {
        clearInterval(sosTimer);
        hideModals();
    }

</script>

</body>
</html>
